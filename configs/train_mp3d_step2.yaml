_BASE_: Base.yaml
MODEL:
  META_ARCHITECTURE: "PlaneTR_NopeSAC"
  MASK_ON: True
  CAMERA_ON: True
  EMBEDDING_ON: True
  HUNGARIAN_MATCHER_ON: True
  LOSS_DETECTION_ON: True
  LOSS_CAMERA_ON: True
  LOSS_EMB_ON: True
  SEM_SEG_HEAD:
    NAME: "PlaneTRHead"
    IN_FEATURES: ["res2", "res3", "res4", "res5"]
    NORM: "GN"
    NUM_CLASSES: 1
    PARAM_ON: True
    CENTER_ON: True
    DEEP_SUPERVISION: True
    LOSS_WEIGHT: 1.0
    DICE_WEIGHT: 1.0
    MASK_WEIGHT: 20.0
    PARAM_WEIGHT_L1: 0.25
    PARAM_HM_WEIGHT_L1: 0.25
    PARAM_WEIGHT_COS: 1.0
    PARAM_WEIGHT_Q: 1.0
    PARAM_WEIGHT_CENTER_INS: 0.5
    PARAM_WEIGHT_ANGLE: 0.0028
    PARAM_WEIGHT_OFFSET: 0.01
  CAMERA_HEAD:
    REFINE_ON: False
    CAM_REC_ON: True
    RAND_ON: True
    INITIAL_CAM_WEIGHT: 1.0
    NAME: "PlaneCameraHead"
  WEIGHTS: "ckpts_mp3d/step1/model_final.pth"

SOLVER:
  IMS_PER_BATCH: 16
  OPTIMIZER: "ADAMW"
  MAX_ITER: 50000
  CHECKPOINT_PERIOD: 2000
  STEPS: (34000, 44000)
  BASE_LR: 0.0001
  GAMMA: 0.1
  BACKBONE_MULTIPLIER: 1.0
  PLANE_MATCHER_HEAD_MULTIPLIER: 1.0
  SEM_SEG_HEAD_MULTIPLIER: 1.0
  CLIP_GRADIENTS:
    ENABLED: False

DATASETS:
  TRAIN: ("mp3d_train",)
  TEST: ("mp3d_val",)

TEST:
  EVAL_PERIOD: 4000
  EVAL_FULL_SCENE: False
  MATCHING_SCORE_THRESHOLD: 0.2

DATALOADER:
  NUM_WORKERS: 4

OUTPUT_DIR: "ckpts_mp3d/step2/"